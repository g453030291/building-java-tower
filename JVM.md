 Java虚拟机所管理的内存将会包括以下几个运行时数据区域：

1.方法区(Method Area)

2.堆(Heap)

<u>（下面三个属于各个线程独享，每个县城创建都会创建此三个数据区，各个线程相互隔离、互不影响）</u>

3.程序计数器(Program Counter Register)

4.java虚拟机栈(VM Stack)

5.本地方法栈(Native Method Stack)

#### 程序计数器：

作用：存储当前线程所执行的字节码的信号指示器

特点：唯一一个Java虚拟机规范中没有规定任何OutOfMemoreError的区域

每一条JVM线程都有自己的计数器

如果当前执行的是java方法，那程序计数器保存的就是JVM正在执行的字节码指令的地址，如果该方法是native，那么程序计数器就是undefined

#### 虚拟机栈：

作用：每一个JVM线程都有自己的虚拟机栈，这个栈与线程同时创建，生命周期与线程相同，用于存储局部变量、操作栈、动态链接、方法出口

虚拟机栈描述的是java方法执行的内存模型：每个方法被执行都会创建一个栈帧，用于存储局部变量表、操作数栈、等信息，每个方法从被调用到执行完成的过程，就对应着栈帧在虚拟机栈中从入栈到出栈的过程。局部变量表存放了各种基本数据类型、对象引用和字节码指令地止。

异常：StackOverflowError：线程请求分配的栈容量超过JVM允许的最大容量

OutOfMemoryError：建立新的线程没有足够的内存

#### 本地方法栈：

作用：java虚拟机使用到java语言之外其他语言写的方法

#### 方法区(包括运行时常量池)：

作用：供各个线程共享的运行时内存区域

特点：方法区在虚拟机启动的时候就创建

​    方法区的容量可以是固定大小，也可以随着程序执行动态扩缩

运行时常量池：每一个类或接口的常量池的运行时表现形式，包括了若干种常量

特点：类和接口被加载到JVM后，所对应的运行时常量池就被创建

#### 堆：

作用：供各线程共享运行的内存区域，供所有类的实例和数据对象分配内存区域

特点：在虚拟机启动的时候被创建，堆中存储了各种对象，被GC管理，无法显式的被销毁

堆是java虚拟机管理的内存最大的区域

通过-Xms和-Xmx更改初始堆大小

堆的容量可以固定，也可以动态扩缩

#### 分析OOM：

Memory Analyzer tool + jmap

利用jmap命令，生成dump文件，查看堆中的对象信息